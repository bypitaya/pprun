var Player=function(a,d,b){this.game=a;this.scene=d;this.gamepad=b;this.mesh;this.body;this.mesh=BABYLON.Mesh.CreateSphere("player",16,10,this.scene);this.mesh.position.y=8;this.mesh.physicsImpostor=new BABYLON.PhysicsImpostor(this.mesh,BABYLON.PhysicsImpostor.SphereImpostor,{mass:2,friction:0,restitution:0.02});d.removeMesh(this.mesh);var e=this;BABYLON.SceneLoader.ImportMesh("","model/pphero18/","pphero18.babylon",d,function(g,h,f){e.body=g[0];var i=f[0];e.body.rotation.y=Math.PI;e.body.scaling=new BABYLON.Vector3(0.3,0.3,0.3);d.beginAnimation(f[0],0,24,true,1);d.registerAfterRender(function(){var j=e.mesh.getAbsolutePosition().clone();j.y-=5;j.z-=1;e.body.setAbsolutePosition(j)})});this.leftPoint=new BABYLON.Vector3(0,0,0);this.rightPoint=new BABYLON.Vector3(0,0,0);this.downPoint=new BABYLON.Vector3(0,0,0);this.fwpoint=new BABYLON.Vector3(0,0,0);var c=new BABYLON.StandardMaterial("matos",this.scene);this.mvtDirection=[0,0,0,0];this.speed=5;this.moveEnergy=5;var e=this;this.moveForward=0;this.moveBackward=0;this.moveRight=0;this.moveLeft=0;this.direction_z=0;this.direction_x=0;this.jump=0;window.addEventListener("keyup",function(f){e.keyUp(f.keyCode)});window.addEventListener("keydown",function(f){e.keyDown(f.keyCode)})};Player.DIRECTIONS={ZQSD:{TOP:90,BOT:83,LEFT:81,RIGHT:68},QWSD:{TOP:87,BOT:83,LEFT:65,RIGHT:68}};Player.ACTIONS={FIRE:{TOP:38,BOT:40,LEFT:37,RIGHT:39}};Player.prototype={update:function(){this.move()},_chooseDirection:function(b,a){this.mvtDirection[b]=a},move:function(){var b=2;this.direction_z=this.moveForward-this.moveBackward;this.direction_x=this.moveRight-this.moveLeft;this.direction_y=this.jump;var a=this.mesh.physicsImpostor.getLinearVelocity().clone();a.z-=a.z*0.1;a.x-=a.x*0.1;if(this.direction_z!=0){a.z+=this.direction_z*10}if(this.direction_x!=0){a.x+=this.direction_x*5}if(this.direction_y>0){a.y=50;this.direction_y=0;this.jump=0}this.mesh.physicsImpostor.setLinearVelocity(a)},handleKeyDown:function(a){switch(a){case Player.DIRECTIONS.ZQSD.TOP:case Player.DIRECTIONS.QWSD.TOP:this._chooseDirection(0,1);break;case Player.DIRECTIONS.ZQSD.BOT:case Player.DIRECTIONS.QWSD.BOT:this._chooseDirection(1,1);break;case Player.DIRECTIONS.ZQSD.LEFT:case Player.DIRECTIONS.QWSD.LEFT:this._chooseDirection(2,1);break;case Player.DIRECTIONS.ZQSD.RIGHT:case Player.DIRECTIONS.QWSD.RIGHT:this._chooseDirection(3,1);break}},keyDown:function(a){switch(a){case 87:this.moveForward=1;console.log("W");break;case 83:this.moveBackward=1;break;case 65:this.moveLeft=1;break;case 68:this.moveRight=1;break;case 32:this.jump=1;break}},keyUp:function(a){switch(a){case 87:this.moveForward=0;break;case 83:this.moveBackward=0;break;case 65:this.moveLeft=0;break;case 68:this.moveRight=0;break;case 32:this.jump=0;break}},handleKeyUp:function(a){switch(a){case Player.DIRECTIONS.ZQSD.TOP:case Player.DIRECTIONS.QWSD.TOP:this._chooseDirection(0,0);break;case Player.DIRECTIONS.ZQSD.BOT:case Player.DIRECTIONS.QWSD.BOT:this._chooseDirection(1,0);break;case Player.DIRECTIONS.ZQSD.LEFT:case Player.DIRECTIONS.QWSD.LEFT:this._chooseDirection(2,0);break;case Player.DIRECTIONS.ZQSD.RIGHT:case Player.DIRECTIONS.QWSD.RIGHT:this._chooseDirection(3,0);break}},destroy:function(){this.mesh.dispose()}};